{{- /*
  Enhanced SEO meta tags partial
  Extends PaperMod theme's default meta tags with additional SEO optimizations
*/ -}}

{{- /* Preconnect hints for performance */ -}}
<link rel="preconnect" href="https://res.cloudinary.com" crossorigin>
<link rel="dns-prefetch" href="https://res.cloudinary.com">
{{- if site.Params.analytics.google.measurementID -}}
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
{{- end -}}

{{- /* Additional meta tags for better SEO */ -}}
{{- if .IsPage -}}
  {{- /* Article-specific meta tags */ -}}
  {{- if .Params.author -}}
  <meta name="author" content="{{ .Params.author }}">
  {{- else if site.Params.author -}}
  <meta name="author" content="{{ site.Params.author }}">
  {{- end -}}
  
  {{- /* Article published time */ -}}
  {{- if .PublishDate -}}
  <meta property="article:published_time" content="{{ .PublishDate.Format "2006-01-02T15:04:05-07:00" }}">
  {{- end -}}
  
  {{- /* Article modified time */ -}}
  {{- if .Lastmod -}}
  <meta property="article:modified_time" content="{{ .Lastmod.Format "2006-01-02T15:04:05-07:00" }}">
  {{- end -}}
  
  {{- /* Article section/category */ -}}
  {{- if .Section -}}
  <meta property="article:section" content="{{ .Section }}">
  {{- end -}}
  
  {{- /* Article tags */ -}}
  {{- $tags := .GetTerms "tags" -}}
  {{- range first 6 $tags -}}
  <meta property="article:tag" content="{{ .Page.Title | plainify }}">
  {{- end -}}
{{- end -}}

{{- /* Language and locale */ -}}
<meta property="og:locale" content="{{ .Language.LanguageCode | default "zh_TW" }}">
<link rel="alternate" hreflang="{{ .Language.Lang | default "zh-tw" }}" href="{{ .Permalink }}">

{{- /* Default Open Graph image fallback */ -}}
{{- if and .IsPage (not .Params.cover.image) -}}
  {{- $images := partial "templates/_funcs/get-page-images" . -}}
  {{- if not $images -}}
    {{- /* Use site default image if available */ -}}
    {{- if site.Params.seo.defaultImage -}}
    <meta property="og:image" content="{{ site.Params.seo.defaultImage }}">
    <meta name="twitter:image" content="{{ site.Params.seo.defaultImage }}">
    {{- end -}}
  {{- end -}}
{{- end -}}
